\documentclass[12pt]{article}
\input{preamble/helper.tex}

\input{preamble/draftwatermark.tex}
\usepackage{braket}
\usepackage{breqn}

\title{Algorithm}
\author{Zakariyya Mughal}
\date{2015-12-12}

\newcommand{\Dim}[1]{\ensuremath{\left|#1\right|}}
\newcommand{\InputVolumeIndices}{\ensuremath{[i,j,k]}}
\newcommand{\InputVolumeName}{\ensuremath{V}}
\newcommand{\InputVolume}{\ensuremath{\InputVolumeName\InputVolumeIndices}}
\newcommand{\InputVolumeDimensions}{\ensuremath{\Dim{\InputVolumeName}_0 \times \Dim{\InputVolumeName}_1 \times \Dim{\InputVolumeName}_2}}

\newcommand{\LaplacianFilterApproxDegree}{\ensuremath{d^{L}}}
\newcommand{\RadiiScalesName}{\ensuremath{r}}
\newcommand{\RadiiScales}{\ensuremath{\RadiiScalesName_{s}}}

\begin{document}
\maketitle
\tableofcontents

For the following, all indices are 0-based in order to match the
indexing found in the \gls{orionc} code and reduce the need for
subtracting one when calculating using indices.

\section{Segmentation}

\subsection{Input}

\begin{description}
	\item[\InputVolume{}] is the input volume of dimensions
		\InputVolumeDimensions{} which contains the intensity values taken
		from the microscope modality.
	\item[\RadiiScales{}] is a \Dim{\RadiiScalesName}-vector where each element
		represents the radius of the neurite to segment.
	\item[\LaplacianFilterApproxDegree{}] is the degree of the
		Taylor series used to calculate the approximation
		to the Laplacian filter.
\end{description}

\subsection{Extract features}

\paragraph{Laplacian scale parameter}

\(\sigma^{L}_{s}\) is a \Dim{\RadiiScalesName}-vector

\paragraph{Hessian scale parameter}

\(\sigma^{G}_{s}\) is a \Dim{\RadiiScalesName}-vector

\paragraph{Laplacian filter (HDAF)}

\(V^{L}_{s}\InputVolumeIndices\) is a \Dim{\RadiiScalesName}-vector of
\Dim{\InputVolumeName} dimensional volumes where each element
contains the filter response for scale \(\sigma^{L}_{s}\).

\paragraph{Hessian filter}

\(\lambda_{s,1}\InputVolumeIndices\),
\(\lambda_{s,2}\InputVolumeIndices\), and
\(\lambda_{s,3}\InputVolumeIndices\) are
a collection of \Dim{\RadiiScalesName}-count
\Dim{\InputVolumeName} dimensional volumes where each element is
the respective eigenvalues \(\lambda_1 \le \lambda_2 \le \lambda_3\) for scale
\(\sigma^{G}_{s}\) (i.e., the eigenvalues are sorted in ascending
order).

\paragraph{Maximal Laplacian filter response}

\begin{dmath*}
R_{\mathrm{max}}^{L}\InputVolumeIndices = \argmax_{s} \(V^{L}_{s}\InputVolumeIndices\)
\end{dmath*}
where \(R_{\mathrm{max}}^{L}\) is a volume of dimension
\(\Dim{\InputVolumeName}\) where each element is an index such that
all elements satisfy
\(0 \le R_{\mathrm{max}}^{L}\InputVolumeIndices < \Dim{\RadiiScalesName}\)

\paragraph{Feature vector}


\begin{dmath*}
F^{G}\InputVolumeIndices = \Set{
\left(
\lambda_{r,2}\InputVolumeIndices,
\lambda_{r,3}\InputVolumeIndices
\right)
|
r = R_{\mathrm{max}}^{L}\InputVolumeIndices
}
\end{dmath*}
where \(F^{G}\) is a volume of dimensions \Dim{\InputVolume} with
elements that are each tuples of length two, that is, the number
of eigenvalues used as features.

\subsection{Discriminant function}

\subsection{Input}

\begin{description}
	\item[\(F^{G}\)] is a volume that contains the feature vector for each
		voxel in the volume.
	\item[\(H_n\)] is a scalar number of bins.
\end{description}

\subsection{Bin bounds and edges}

The 2D histogram minima and maxima are computed for each feature
\begin{dmath*}
	h_{\mathrm{min},q} = \min \Set{ f_q | f_q \in ( f_0, f_1 ) = f \in F^{G} }
\end{dmath*}
\begin{dmath*}
	h_{\mathrm{max},q} = \max \Set{ f_q | f_q \in ( f_0, f_1 ) = f \in F^{G} }
\end{dmath*}

Bin edges are computed for each \(\mnth{q}\) feature
\begin{dmath*}
	b_q[w] =
		h_{\mathrm{min},q} +
		\frac{ h_{\mathrm{max},q}  - h_{\mathrm{min},q}  }
		     { H_n } \, w
\end{dmath*}
where \(w\) is the index of the leading edge to the
\(\mnth{w}\) bin and \( 0 \le w \le  H_n \).

\subsection{Histogram accumulation}

\begin{dmath*}
	H[x,y] =  \Dim{ \operatorname{Bin}(F^G, x, y) }
\end{dmath*}
where \(H[x,y]\) is a \(H_n \times H_n\) matrix and
where \(\operatorname{Bin}(F^G, x, y)\) is the set of all tuples
\((f_0, f_1) \in F^G\) such that
\begin{enumerate}
	\item \(b_0[x] \le f_0 < b_0[x+1]\) and
	\item \(b_1[y] \le f_1 < b_1[y+1]\).
\end{enumerate}



\section{Tracing}

\end{document}
