%% vim:tw=66:spell:wrap:ft=tex:
\ifx \printpresenthandout \undefined
	\ifx \printpresentarticle \undefined
		% no handout and no article
		\documentclass{beamer}
	\else
		% print article
		\documentclass[11pt]{article}
		\usepackage{beamerarticle}
	\fi
\else
	% handout
	\documentclass[handout]{beamer}
\fi
% Preamble
\input{preamble/present-helper.tex}
\colorlet{tbackground}{blue!80}
\colorlet{tobjectives}{red!80}
\colorlet{tmetrics}{green!120}
\ifx \tcolor \undefined
	% no color
	\newcommand{\tbackground}[1]{#1}
	\newcommand{\tobjectives}[1]{#1}
	\newcommand{\tmetrics}[1]{#1}
\else
	\newcommand{\tbackground}[1]{\textcolor{tbackground}{#1}}
	\newcommand{\tobjectives}[1]{\textcolor{tobjectives}{#1}}
	\newcommand{\tmetrics}[1]{\textcolor{tmetrics}{#1}}
\fi

\input{preamble/draftwatermark.tex}

\begin{document}
% meta needs to be in \begin{document} so that tabular works
\input{meta/defense.tex}
%% transitions are made transparent rather than hidden
\setbeamercovered{transparent}
\input{00_front-matter/notation.tex}
%  - Title slide.%{{{
\frame{\titlepage}
%}}}

\ifx \tcolor \undefined
\else
	The following text is color-coded based on what kind of
	information it provides the audience:
	\tbackground{background information},
	\tobjectives{objectives},
	\tmetrics{metrics for completion of objectives}.
\fi

\ifx \printpresentarticle \undefined \else
	\tableofcontents
\fi

\section{Background}
\subsection{Neuron reconstruction}
\begin{frame}\frametitle{\subsecname}
	\centering
	\begin{tabular}{c}
	\vertcenterimage{\flipbox{\includegraphics[width=0.8\textwidth]{gfx/present/neuron-vol}}} \\\\
	\arrowdown \\\\
	\vertcenterimage{\includegraphics[width=0.8\textwidth]{gfx/present/neuron-trace}}
	\end{tabular}
	\note{%
		Data
		[\tbackground
			{%
				what is neuron reconstruction; data acquisition; image analysis; why
				automate (i.e., why automated neuron
				tracing research is important);
				mention ORION
			}
		]
	}
	\note{
		% TODO more notes
		\begin{itemize}
		\item
		  confocal and two-photon microscopy
		\item
		  fluorescent proteins on a single neuron
		\item
		  sampled in 3D
		\item
		  problems with manual tracing

		  \begin{itemize}
		  \item
		    slow: can take up to 24 hours of work by domain expert on a single
		    neuron
		  \item
		    difficult in 3D
		  \end{itemize}
		\item
		  problems in general

		  \begin{itemize}
		  \item
		    faint intensity
		  \item
		    lots of noise
		  \end{itemize}
		\end{itemize}
	}
\end{frame}

\subsection{Open science}
\begin{frame}\frametitle{\subsecname}
\centering
\begin{tabular}{p{0.6\textwidth}c}
	\begin{minipage}{\linewidth}
	\begin{quote}
		\begin{fancyquote}
		Open science is the idea that scientific knowledge of all kinds
		should be openly shared as early as is practical in the discovery
		process.
		\end{fancyquote}
		--- \qauthor{Michael Nielsen}
	\end{quote}
	\end{minipage}
	&
	\vertcenterimage{\includegraphics[height=0.3\textheight]{gfx/present/michael-nielsen}}
\end{tabular}
	\note{
		% TODO more notes
		Scientific knowledge
		\begin{itemize}
		\item
		  problem definitions
		\item
		  ideas
		\item
		  code
		\item
		  data
		\item
		  methodology
		\item
		  journal articles
		\end{itemize}
	}
	\note{
		% TODO more notes
		[\tbackground
			{%
			what it means to be an open-science project (i.e., open release of all
			research artifacts as early as possible)
			}
		]
	}
\end{frame}

\subsection{BigNeuron}
\begin{frame}\frametitle{\subsecname}
	\centering
	\includegraphics[height=0.6\textheight]{gfx/bigneuron-website}
	\note{
		% TODO more notes
		[\tbackground
			{%
				goal of BigNeuron and purpose of participation in
				BigNeuron and how each algorithm must be released under
				open-science
			}
		]
	}
	\note{
		% TODO more notes
		\begin{itemize}
		\item
		  Continuing where the DIADEM Challenge left off
		\item
		  Comparing algorithms across large datasets
		\item
		  Stitching multiple neuron reconstructions together
		\end{itemize}
	}
\end{frame}

\section{Problem}
%  - Problem Statement - Goals, objectives, aims. May also include challenges.
%        IMPORTANT: State your specific aims clearly - what you plan to achieve and how
%        you plan to achieve it. Let your contributions to the field of Computer Science
%        be clear.
\begin{frame}\frametitle{\secname}
	\Huge
	\renewcommand{\arraystretch}{1.5}% Spread rows out...
	\begin{tabular}{m{5em}m{1em}m{4em}m{1em}}
		BigNeuron & + & \vertcenterimage{\includegraphics[height=2em]{gfx/present/mathworks-logo}} & \textcolor{red}{\xmark} \\[1em]
		BigNeuron & + & C/C++ & \textcolor{green}{\cmark}
	\end{tabular}
	\note{
		% TODO more notes
		[\tbackground{explain how the ORION code exists in MATLAB form but is difficult to
		integrate into BigNeuron}; explain challenges in later slides]
	}
\end{frame}

\section{Goal}
%  - Motivation - short introduction to your research, pointers to applications, why the research is important.
\begin{frame}\frametitle{\secname}
	\centering
	\tobjectives{%
	The reimplementation of  a system
	%
		for \alert{neuron reconstruction}
	%
		that is distributed as an \alert{open-science} project
		and
	%
		compatible with the \alert{BigNeuron} project.
	%
	}
\end{frame}

\subsection{Objectives}
\begin{frame}\frametitle{\subsecname}
	\tobjectives{%
	% TODO choose icons for each objective to put in the slide
	% headers
	% - conversion : recycle?
	% - integration: gears?
	% - testing: Erlenmeyer flask (for science)?
	\begin{enumerate}[<+->]
		\setlength\itemsep{1em}
		\item convert the ORION algorithm: \gls{orionmat} $\rightarrow$ \gls{orionc};
		\item integrate \gls{orionc} with Vaa3D;
			and % "and" before last item
		\item create a test suite and ensure
			reproducible results. % end of sentence
	\end{enumerate}
	}
\end{frame}

\section{Context}
%  - Related Work - a catchy name is “State of the Art”.
%        Literature review relevant to specific research. Your committee
%        members are expected to already have a general background in your field.
%        Concentrate on the details of your specific research area. It is preferable to
%        use more recent literature (except for some classical “old” ones). Also avoid
%        reviewing standard concepts that have been around for a long time.
\begin{frame}\frametitle{\secname}
	\tbackground{%
	\begin{itemize}
		\item Prior work in \alert{neuron reconstruction}
		\item Principles of \alert{open-science}
		\item An overview of \alert{BigNeuron}
	\end{itemize}
	}
\end{frame}

\subsection{Neuron reconstruction}
\begin{frame}\frametitle{\subsecname}
	% TODO
	[\tbackground{explain the problem of neuron reconstruction; history of
	neuron tracing; biological relevance and applications}]
\end{frame}

\subsubsection{DIADEM Challenge}
\begin{frame}\frametitle{\subsubsecname}
	% TODO
	[\tbackground{explain DIADEM Challenge; data sets; outcomes}]
\end{frame}

\subsubsection{Metrics}
\begin{frame}\frametitle{\subsubsecname}
	% TODO
	[\tbackground{Create a table of metrics (e.g., precision, recall,
	DIADEM metric, btmorph, NetMets) and explain how they work}]
\end{frame}

\subsubsection{Methods}
\begin{frame}\frametitle{\subsubsecname}
	% TODO
	[\tbackground{Create a table of methods: what data they work with (2D/3D), modality,
	metrics, what datasets they validated against}]
\end{frame}

\subsection{Open science}
\begin{frame}\frametitle{\subsecname}
	% TODO
	[\tbackground{explain open science}]
\end{frame}

\subsubsection{``Bermuda Principles''}
\begin{frame}\frametitle{\subsubsecname}
	Bermuda Principles (1996):
	\begin{itemize}
		\item data available in 24 hours of sequence assembly
		\item immediate publication of annotated sequences
		\item all data in the public domain
	\end{itemize}
	\note{
		\begin{itemize}
		\item
		  Human Genome Project: one of the earliest open research projects; 20 institutions from around the world; 13 years
		\item
		  arose after patent of breast cancer gene (BRCA2)
		\end{itemize}
	}
	\note{
	% TODO
	[\tbackground{explain ``Bermuda Principles'' from Human Genome Project
	(early large-scale open research project)}]
	}
\end{frame}

\subsubsection{Open science projects}
\begin{frame}\frametitle{\subsubsecname}
\centering
\begin{tabular}{cc}
	% Human Genome Project
	\includegraphics[height=0.3\textheight]{gfx/present/HGP}
	&
	% OpenWorm
	\includegraphics[height=0.3\textheight]{gfx/present/OpenWormLogo}
	\\
	% Galaxy Zoo
	\includegraphics[height=0.3\textheight]{gfx/present/Galaxyzoo}
	&
	% Allen Brain Atlas
	\includegraphics[height=0.3\textheight]{gfx/present/allen_brain_atlas_screenshot}
\end{tabular}
	\note{
		\begin{itemize}
		\item
		  Human Genome Project
		\item
		  OpenWorm: \emph{C. elegans} connectome modelling
		\item
		  GalaxyZoo: crowd-source classification of galaxies
		\item
		  Allen Brain Atlas: anatomical atlases of mouse and human brain
		\end{itemize}
	}
	% TODO
	\note{
	[\tbackground{showcase a few open science projects to show breadth}]
	}
\end{frame}

\subsection{BigNeuron}
\begin{frame}\frametitle{\subsecname}
	\centering
	\includegraphics[height=0.3\textheight]{gfx/present/alleninsitute12}
	\note{
	% TODO
	[\tbackground{explain what BigNeuron is; how it relates to this thesis;
		neuron stitching; bench testing}]
	}
\end{frame}

\subsubsection{Vaa3D}
\begin{frame}\frametitle{\subsubsecname}
	\centering
	\includegraphics[height=0.5\textheight]{gfx/present/vaa3d-logo}
	\note{
		Standardising on Vaa3D image analysis tool
	}
	\note{
	% TODO
	[\tbackground{explain how Vaa3D has a plugin architecture and how it
	standardizes the BigNeuron project}]
	}
\end{frame}

\begin{frame}\frametitle{Vaa3D}
	\centering
	\includegraphics[height=0.5\textheight]{gfx/present/vaa3d-load-swc}
	\note{
		This is a neuron tracing loaded into Vaa3D.
	}
\end{frame}

%  - Proposed Framework - this is the most important part of your proposal.
%        Expect most questions from committee members on this. Put in all your
%        best here. Describe the entire framework before separating into work-done and
%        work-left. Do not mix framework with results. You may start with a one-slide
%        overview of the entire framework before going into details. Make sure committee
%        members will be able to understand your work. Relate to previous approaches and
%        how your is an extension or a difference. Include mathematical equations that
%        will explain your work.
%  - Explain the relevance of each equation. Understand the meaning and
%        significance of each term in the equation irrespective of whether you define
%        them in the slide or not. TIP: Rather than doing your equation twice (for your
%        PPT and Latex write-up), you may do it once in your Latex document and copy
%        into TexPoint for the PPT.
%  - Preliminary Results - if you already have some results, please show it.
%        Talk about how you propose to validate your results. Show how your
%        results compare with previous results OR how it performs in general, (e.g., in
%        how many images it succeeded or in how many it failed). A chart will be useful.
%        Any statistical comparison should indicate level of significance.
%  - Present status of the proposed framework
%        - which aspects are completed, which are in progress, and which have not yet been done at all.
%  - It is advisable to include a timeline of future indicating milestones and when you hope to achieve each.
%  - Expected Impact - mention specific application areas where you have tried or will try your proposed framework.
%        Also, explain how it can be generalized to other areas in Computer
%        Science. What is the overall benefit for the community? What is the
%        contribution to Computer Science research?

\section{Methods}

\subsection{Conversion}
\begin{frame}\frametitle{\subsecname}
	[\tbackground{explain difficulties with a rewrite vs.\ a refactor}]
\end{frame}

\subsubsection{Conversion challenges}
\begin{frame}\frametitle{\subsubsecname}
	[\tbackground{challenges when doing a rewrite from MATLAB to native code}]
\end{frame}

\subsubsection{Call graph}
\begin{frame}\frametitle{\subsubsecname}
	[\tbackground{analysis of existing codebase; how this informs the new
	implementation; why use the call graph instead of
	attempting to either do a clean room implementation (i.e.,
	by only reading papers) or creating a new architecture
	from scratch}]
\end{frame}

\subsubsection{Directory structure}
\begin{frame}\frametitle{\subsubsecname}
	% TODO
	[ plan for the directory structure (where does each file
	go) ]
\end{frame}

\subsection{Integration}
\begin{frame}\frametitle{\subsecname}
	[\tbackground{description of Vaa3D}]
\end{frame}

\subsubsection{Vaa3D integration}
\begin{frame}\frametitle{\subsubsecname}
	[how to integrate with Vaa3D]
\end{frame}

\subsection{Testing and Reproducibility}
\begin{frame}\frametitle{\subsecname}
	[\tmetrics{why testing is important}]
\end{frame}

\subsubsection{Testing procedure}
\begin{frame}\frametitle{\subsubsecname}
	[
		testing procedure (TAP harness, floating point
		issues); integration testing with Vaa3D
	]
\end{frame}

\section{Results}

\subsection{Results for Conversion}

\subsubsection{Qualitative results}
\begin{frame}\frametitle{\subsecname}
	% TODO
	[
		\tmetrics{%
			run code on DIADEM data and show the
			visualization
		}
	]
\end{frame}

\subsubsection{Quantitative Tracing-based comparison}
\begin{frame}\frametitle{\subsecname}
	% TODO
	[ get all intermediate results from MATLAB code and
	compare to the native code (floating point for volumes,
	tree metrics for the tracings); run on DIADEM data]
\end{frame}

\subsection{Results for Integration}
\begin{frame}\frametitle{\subsecname}
	[\tmetrics{a demonstration video; visual results and metrics from using
			Vaa3D with neuron data from DIADEM; demonstration of any further analysis
	that can be done in Vaa3D}]

\end{frame}

\begin{frame}% TODO title
\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{gfx/vaa3d_DIADEM-NPF-3-025_3D-view}
\caption{Vaa3D: Visualization of NPF025 TIFF stack}
\end{figure}
\end{frame}

\begin{frame}% TODO title
\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{gfx/vaa3d_DIADEM-NPF-3-025_APP2-tracing-3D-view}
\caption{Vaa3D: Tracing of NPF025 using Vaa3D APP2 plugin}
\end{figure}
\end{frame}

\subsection{Results for Testing and Reproducibility}

\subsubsection{Overview of tests}
\begin{frame}\frametitle{\subsubsecname}
	[
		overview of tests written (grouped by similarity);
		list of bugs fixed in ORION due to testing;
		code coverage; list of dead code found
	]
\end{frame}

\subsubsection{Dependency tracking}
\begin{frame}\frametitle{\subsubsecname}
	[dependency tracking by keeping version controlled copies
		of dependencies; screenshots of all repos of deps used under the CBL-ORION
	namespace on GitHub
	\begin{itemize}
		\item ITK
		\item Vaa3D
		\item kiss-fft
	\end{itemize}
	]
\end{frame}

\subsubsection{Documentation}
\begin{frame}\frametitle{\subsubsecname}
	[ screenshot of documentation ]
		\begin{figure}[tbp]
			\centering
			% <https://github.com/CBL-ORION/orion/wiki>
			\includegraphics[width=1.0\textwidth]{gfx/doc_placeholder}
			\caption{\textbf{Documentation website}
			}\label{fig:doc-wiki}
		\end{figure}
\end{frame}


\subsubsection{Continuous integration}
\begin{frame}\frametitle{\subsecname}
	% TODO
	[
		{screenshots of continuous integration}
	]
\end{frame}

\begin{frame}\frametitle{Estimating error in stages}
        \centering
	\begin{tabular}{|p{2cm}|c|c|c|c|}
		\toprule
                                         & one                    & two                    & three                  & four                   \\%\hline
		\midrule
                  \hline
                  \gls{orionmat}         & \cellcolor{langM} x(1) & \cellcolor{langM} x(2) & \cellcolor{langM} x(3) & \cellcolor{langM} x(4) \\%\hline
                  \gls{orionc}           & \cellcolor{langC} x[0] & \cellcolor{langC} x[1] & \cellcolor{langC} x[2] & \cellcolor{langC} x[3] \\%\hline
                  C with Matlab          & \cellcolor{langCM} 4   & \cellcolor{langCM} 3   & \cellcolor{langCM} 2   & \cellcolor{langCM} 1   \\%\hline

                  Matlab - C             & \cellcolor{diffone} 4  & \cellcolor{diffone} 3  & \cellcolor{diffone} 2  & \cellcolor{diffone} 1  \\%\hline
                  Matlab - C with Matlab & \cellcolor{difftwo} 4  & \cellcolor{difftwo} 3  & \cellcolor{difftwo} 2  & \cellcolor{difftwo} 1  \\%\hline
		  \bottomrule
        \end{tabular}
\end{frame}



\begin{frame}\frametitle{Estimating error in stages (vertical)}
        \centering
        \begin{tabular}{|l|c|c|c|c|}
		stage  & \gls{orionmat}         & \gls{orionc}           & C with Matlab           & Matlab - C               & Matlab - C with Matlab   \\ \hline
		\hline
		one    & \cellcolor{langM} x(1) & \cellcolor{langC} x(2) & \cellcolor{langCM} x(3) & \cellcolor{diffone} x(4) & \cellcolor{difftwo} x(4) \\ \hline
		two    & \cellcolor{langM} x[0] & \cellcolor{langC} x[1] & \cellcolor{langCM} x[2] & \cellcolor{diffone} x[3] & \cellcolor{difftwo} x(4) \\ \hline
		three  & \cellcolor{langM} 4    & \cellcolor{langC} 3    & \cellcolor{langCM} 2    & \cellcolor{diffone} 1    & \cellcolor{difftwo} x(4) \\ \hline

        \end{tabular}
        \note{
                1-based arrays in MATLAB vs. 0-based arrays in C
        }
\end{frame}


\section{Conclusion}
%  - Conclusion slide could be catchy, something they will remember.
%        Maybe an animation, video, or terse statement that summarizes it all.
\begin{frame}\frametitle{\secname}
	[
		mention future work (e.g., NeuroDebian)
	]
\end{frame}


%  - Publications - you should list your publications or mention them in relevant sections of the presentation.


\end{document}
